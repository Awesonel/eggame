# Запуск приложения

Для запуска приложения выполните следующие шаги:

1. **Запуск Docker-контейнеров**:

   Убедитесь, что у вас установлен Docker и Docker Compose. Затем в корневой директории проекта выполните команду:

    ```bash
    docker-compose up
    ```

   Эта команда запустит PostgreSQL базу данных, необходимую для работы приложения.

2. **Запуск приложения**:

   Найдите файл `EggameApplication.kt` в проекте и запустите метод `main`:

    ```kotlin
    fun main(args: Array<String>) {
        runApplication<EggameApplication>(*args)
    }
    ```

   Это запустит ваше приложение.


---
# Документация API

## Обзор

Этот API предоставляет эндпоинты
для регистрации пользователей, получения их очков,
обновления очков пользователей
и получения списка всех пользователей в виде таблицы лидеров.
Ниже приведены детали для каждого эндпоинта.

---

## Эндпоинты

### 1. Регистрация

- **URL**: `/api/users/register`
- **Метод**: `POST`
- **Тело запроса**:
    ```json
    {
        "name": "string"
    }
    ```
    - `name` (строка): Имя пользователя для регистрации. Не может быть пустым.

- **Ответы**:
    - **200 OK**:
        ```json
        {
            "name": "string",
            "score": 0
        }
        ```
        - `name` (строка): Имя зарегистрированного пользователя.
        - `score` (число): Начальное количество очков пользователя (по умолчанию 0).
    - **400 Bad Request**:
        ```
        Имя пользователя не может быть пустым
        ```
        - Причина: Предоставленное имя пустое.
    - **409 Conflict**:
        ```
        Пользователь с таким именем уже существует
        ```
        - Причина: Пользователь с предоставленным именем уже существует.

- **Пример запроса**:
    ```http
    POST /api/users/register HTTP/1.1
    Host: localhost:8080
    Content-Type: application/json

    {
        "name": "JohnDoe"
    }
    ```

- **Пример ответа**:
    ```http
    HTTP/1.1 200 OK
    Content-Type: application/json

    {
        "name": "JohnDoe",
        "score": 0
    }
    ```

### 2. Получение счета пользователя

- **URL**: `/api/users/score`
- **Метод**: `GET`
- **Параметры запроса**:
    - `name` (строка): Имя пользователя, счет которого нужно получить.

- **Ответы**:
    - **200 OK**:
        ```json
        {
            "name": "string",
            "score": 100
        }
        ```
        - `name` (строка): Имя пользователя.
        - `score` (число): Счет пользователя.
    - **404 Not Found**:
        ```
        Пользователь с именем <name> не найден
        ```
        - Причина: Пользователь с предоставленным именем не найден.

- **Пример запроса**:
    ```http
    GET /api/users/score?name=JohnDoe HTTP/1.1
    Host: localhost:8080
    ```

- **Пример ответа**:
    ```http
    HTTP/1.1 200 OK
    Content-Type: application/json

    {
        "name": "JohnDoe",
        "score": 100
    }
    ```

### 3. Обновление счета пользователя

- **URL**: `/api/users/score`
- **Метод**: `PUT`
- **Тело запроса**:
    ```json
    {
        "name": "string",
        "score": 100
    }
    ```
    - `name` (строка): Имя пользователя, счет которого нужно обновить.
    - `score` (число): Новый счет пользователя.

- **Ответы**:
    - **200 OK**:
        ```json
        {
            "name": "string",
            "score": 100
        }
        ```
        - `name` (строка): Имя пользователя.
        - `score` (число): Обновлённый счет пользователя.
    - **404 Not Found**:
        ```
        Пользователь с именем <name> не найден
        ```
        - Причина: Пользователь с предоставленным именем не найден.

- **Пример запроса**:
    ```http
    PUT /api/users/score HTTP/1.1
    Host: localhost:8080
    Content-Type: application/json

    {
        "name": "JohnDoe",
        "score": 150
    }
    ```

- **Пример ответа**:
    ```http
    HTTP/1.1 200 OK
    Content-Type: application/json

    {
        "name": "JohnDoe",
        "score": 150
    }
    ```

### 4. Получение таблицы лидеров

- **URL**: `/api/users/leaderboard`
- **Метод**: `GET`
- **Ответы**:
    - **200 OK**:
        ```json
        [
            {
                "name": "string",
                "score": 100
            },
            {
                "name": "string",
                "score": 50
            }
        ]
        ```
        - Список отсортирован по убыванию очков.
        - Каждый элемент массива содержит:
          - `name` (строка): Имя пользователя.
          - `score` (число): Счет пользователя.
    - **204 No Content**:
        - Причина: В базе данных нет пользователей.

- **Пример запроса**:
    ```http
    GET /api/users/leaderboard HTTP/1.1
    Host: localhost:8080
    ```

- **Пример ответа**:
    ```http
    HTTP/1.1 200 OK
    Content-Type: application/json

    [
        {
            "name": "JohnDoe",
            "score": 100
        },
        {
            "name": "JaneDoe",
            "score": 50
        }
    ]
    ```

---

## Коды ошибок

- **400 Bad Request**: Запрос был некорректным или отсутствуют параметры.
- **404 Not Found**: Запрашиваемый ресурс не найден.
- **409 Conflict**: Запрос не может быть выполнен из-за конфликта с текущим состоянием ресурса.
